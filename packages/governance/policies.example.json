[
    {
        "id": "azure.rg.naming",
        "description": "Resource groups must use prefix rg- and only lowercase letters, numbers, hyphens; no spaces.",
        "target": {
            "tool": "azure.create_resource_group"
        },
        "effect": "deny",
        "checks": [
            {
                "type": "noSpaces",
                "path": "name",
                "message": "RG name cannot contain spaces"
            },
            {
                "type": "regex",
                "path": "name",
                "pattern": "^rg-[a-z0-9-]+$",
                "message": "RG name must match ^rg-[a-z0-9-]+$"
            }
        ]
    },
    {
        "id": "azure.rg.location",
        "description": "Allowed RG locations",
        "target": {
            "tool": "azure.create_resource_group"
        },
        "effect": "deny",
        "checks": [
            {
                "type": "allowedValues",
                "path": "location",
                "values": [
                    "eastus",
                    "eastus2",
                    "usgovvirginia"
                ]
            }
        ]
    },
    {
        "id": "azure.rg.tags",
        "description": "Required RG tags",
        "target": {
            "tool": "azure.create_resource_group"
        },
        "effect": "deny",
        "checks": [
            {
                "type": "requiredTags",
                "path": "tags",
                "keys": [
                    "owner",
                    "costCenter",
                    "env"
                ]
            }
        ]
    },
    {
        "id": "github.repo.naming",
        "description": "Repos must be private and follow kebab-case",
        "target": {
            "tool": "github.create_repo"
        },
        "effect": "deny",
        "checks": [
            {
                "type": "regex",
                "path": "name",
                "pattern": "^[a-z0-9-]+$",
                "message": "Repo name must be kebab-case (lowercase, digits, hyphens)"
            }
        ]
    },
    {
        "id": "github.repo.naming",
        "target": {
            "tool": "github.create_repo_from_template"
        },
        "effect": "deny",
        "checks": [
            {
                "type": "regex",
                "path": "name",
                "pattern": "^[a-z0-9-]+$",
                "message": "Repo name must be kebab-case (lowercase, digits, hyphens)"
            }
        ]
    }
]